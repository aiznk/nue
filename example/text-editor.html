<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Text Editor</title>
	<style>
		/* ========== Reset ========== */
		* {
			box-sizing: border-box;
		}
		body {
			font-family: "Segoe UI", "Hiragino Sans", sans-serif;
			background: #f4f6f9;
			display: flex;
			justify-content: center;
			align-items: center;
			height: 100vh;
			margin: 0;
		}

		/* ========== Root Layout ========== */
		.root {
			display: flex;
			flex-direction: column;
			width: 900px;
			height: 600px;
			background: #fff;
			border-radius: 12px;
			box-shadow: 0 10px 25px rgba(0,0,0,0.08);
			overflow: hidden;
		}
		.top {
			display: flex;
			flex: 1;
			overflow: hidden;
		}
		.bottom {
			border-top: 1px solid #e0e4ea;
			padding: 0.75rem 1rem;
			font-size: 0.9rem;
			color: #555;
			background: #fafbfc;
		}

		/* ========== Left Pane (List) ========== */
		.left {
			width: 25%;
			background: #f7f9fb;
			border-right: 1px solid #e1e6ec;
			padding: 1rem;
			display: flex;
			flex-direction: column;
		}
		.list {
			list-style: none;
			padding: 0;
			margin: 0;
			display: flex;
			flex-direction: column;
			gap: 0.5rem;
		}
		.list-item {
			padding: 0.6rem 0.8rem;
			border: 1px solid #d8dee7;
			border-radius: 6px;
			background: #fff;
			cursor: pointer;
			transition: all 0.2s ease;
			font-size: 0.95rem;
			color: #333;
		}
		.list-item:hover {
			background: #eef3fa;
			border-color: #c7d4ee;
		}
		.list-item.active {
			background: #e2ebfd;
			border-color: #9db6ff;
			color: #204ac8;
			font-weight: 600;
		}

		/* ========== Right Pane (Editor) ========== */
		.right {
			flex: 1;
			display: flex;
			flex-direction: column;
			padding: 1rem;
			overflow: hidden;
		}
		.text-frame {
			display: flex;
			flex-direction: column;
			height: 100%;
		}
		.text-label {
			font-weight: 600;
			color: #333;
			margin-bottom: 0.5rem;
		}
		.textarea {
			flex: 1;
			width: 100%;
			resize: none;
			padding: 1rem;
			font-size: 1rem;
			border: 1px solid #d8dee7;
			border-radius: 6px;
			background: #fdfdfd;
			line-height: 1.6;
			outline: none;
			transition: border 0.2s ease, box-shadow 0.2s ease;
		}
		.textarea:focus {
			border-color: #9db6ff;
			box-shadow: 0 0 0 2px rgba(157,182,255,0.3);
			background: #fff;
		}
	</style>

	<script type="module">
		import * as nue from "../nue.js"

		const AAA = `This is AAA text.
This is AAA text.
This is AAA text.
`
		const BBB = `This is BBB text.
This is BBB text.
This is BBB text.
`
		const CCC = `This is CCC text.
This is CCC text.
This is CCC text.
`

		class List extends nue.Ul {
			constructor () {
				super({ class: 'list' })
			}
		}

		class ListItem extends nue.Li {
			constructor (text) {
				super({ class: 'list-item' })
				this.text = text
				this.setText(text)
			}
			onClick (ev) {
				ev.text = this.text
				this.emit('clickListItem', ev)
			}
		}

		class Textarea extends nue.Textarea {
			constructor () {
				super({ class: 'textarea' })
			}
			onInput (ev) {
				this.emit('inputText', ev)
			}
		}

		class TextFrame extends nue.Div {
			constructor (refCurrentItem) {
				super({ class: 'text-frame' })
				this.refCurrentItem = refCurrentItem

				this.label = this.gen('label', 'Item:', { class: 'text-label' })
				this.textarea = new Textarea()
				this.add(this.label)
				this.add(this.textarea)

				this.default = `Please select a list item.`
				this.textarea.setValue(this.default)

				this.refCurrentItem.onSet((_, itemName) => this.update(itemName))
			}
			update (itemName) {
				this.label.setText('Item: ' + itemName)
				switch (itemName) {
					case 'aaa': this.textarea.setValue(AAA); break
					case 'bbb': this.textarea.setValue(BBB); break
					case 'ccc': this.textarea.setValue(CCC); break
					default: this.textarea.setValue(this.default)
				}
			}
		}

		class Root extends nue.Root {
			constructor () {
				super('div', { class: 'root' })

				this.refCurrentItem = nue.ref(null)

				this.top = this.gen('div', { class: 'top' })
				this.bottom = this.gen('div', { class: 'bottom' })

				this.left = new nue.Div({ class: 'left' })
				this.right = new nue.Div({ class: 'right' })
				this.top.add(this.left)
				this.top.add(this.right)

				this.status = new nue.P({ class: 'status' })
				this.status.setText('Welcome! Select an item from the list.')
				this.bottom.add(this.status)

				this.list = new List()
				this.left.add(this.list)

				this.items = ['aaa', 'bbb', 'ccc'].map(name => new ListItem(name))
				this.items.forEach(item => this.list.add(item))

				this.textarea = new TextFrame(this.refCurrentItem)
				this.right.add(this.textarea)
			}

			receive (key, ev) {
				switch (key) {
					case 'clickListItem':
						this.refCurrentItem.value = ev.text
						this.status.setText(`Selected list item "${ev.text}"`)
						this.updateActiveItem(ev.text)
						break
					case 'inputText':
						this.status.setText(`Typing...`)
						break
				}
			}

			updateActiveItem (text) {
				for (let item of this.items) {
					if (item.text === text) item.el.classList.add('active')
					else item.el.classList.remove('active')
				}
			}
		}

		document.addEventListener('DOMContentLoaded', () => {
			let root = new Root()
			root.mount('#app')
		})
	</script>
</head>
<body>
	<div id="app"></div>
</body>
</html>